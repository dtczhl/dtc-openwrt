#!/bin/bash


sleepTime=62

sendLengthList=$(seq 100 100 5000)

# get filename of this script
MY_FILENAME="$(basename "$0")"

usage (){
cat <<EOF
$MY_FILENAME
    --client
    --server
EOF
}

argumentProcess (){
    
    if [ $# -eq 0 ]; then
        # show help info
        usage
        exit
    fi

    key="$1"
    case $key in
    --server) # server
        dtcUdpTxRxDataCollector -l &
        ;;
    --client) # client
        for i in ${sendLengthList[*]}; do
            sendLength=$i
            sed -i -e "s/sendLength=.*/sendLength=${sendLength}/" /bin/dtcUdpTxRxDataCollector
            dtcUdpTxRxDataCollector -r &
            sleep $sleepTime
            dtcUdpTxRxDataCollector -s
        done 
        ;;
    *) 
        echo "Unknow argument $key"
        exit
        ;;
    esac

}

argumentProcess $@
